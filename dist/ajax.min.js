/**!
 * baby-ajax - v1.2.2
 * One is only 5KB ajax library
 *
 * Thu Oct 18 2018 14:13:05 GMT+0800 (中国标准时间)
 * MIT (c) hold-baby
*/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Ajax=e()}(this,function(){"use strict";function i(t,e,o){for(var s in this.type=t,this.opts=e,this.postData=o,this.catch=e.catch||function(){},this.xmlHttp=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),this.xmlHttp.open(e.method,e.url,e.async),this.xmlHttp.withCredentials=e.withCredentials,this.opts.headers)this.xmlHttp.setRequestHeader(s,this.opts.headers[s]);return"methods_1"==t?this.xmlHttp.send(null):this.xmlHttp.send(this.postData),this}function s(t,e){for(var o in e)t[o]=e[o];return e}function a(e){try{var o=JSON.parse(e.responseText)}catch(t){o=e.responseText}return{status:e.status,data:o}}function n(t){return new i("methods_1",t)}function r(t){var e=t,o=[];for(var s in e.data)o.push(s+"="+e.data[s]);o.join("&");return new i("methods_2",e,JSON.stringify(e.data))}function p(t){return{res:JSON.parse(t.target.responseText),status:t.target.status}}function l(t,e){var l,d,h=this;this.dom=e,this.opt=t,this.xmlHttp=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),this.xmlHttp.onload=function(t){var e=p(t).res,o=p(t).status;h.fileItem.isUpload=!0,h.fileItem.isUploadding=!1,h.onSuccessItem(h.fileItem,e,o),h.clearUploadFile()},this.xmlHttp.onerror=function(t){var e=p(t).res,o=p(t).status;h.fileItem.isError=!0,h.fileItem.isUploadding=!1,h.onErrorItem(h.fileItem,e,o),h.clearUploadFile()},this.xmlHttp.upload.onprogress=function(t){var e={},o={};t.lengthComputable&&(o.max=t.total,o.value=t.loaded,e.percent=Math.round(t.loaded/t.total*100));var s=((new Date).getTime()-l)/1e3;l=(new Date).getTime();var i=t.loaded-d;d=t.loaded;var a=i/s,n=a,r="b/s";1<a/1024&&(a/=1024,r="kb/s");1<a/1024&&(a/=1024,r="Mb/s");a=a.toFixed(1);var p=((t.total-t.loaded)/n).toFixed(1);e.speed=a+r,e.resttime=p,0==n&&(e.bspeed="上传已取消");h.onProgressItem(h.fileItem,e)},this.onSuccessItem=function(){},this.onBeforeUploadItem=function(){},this.onErrorItem=function(){},this.onProgressItem=function(){},this.xmlHttp.upload.onloadstart=function(){l=(new Date).getTime(),d=0,h.fileItem.isUploadding=!0},this.dom.onchange=function(){h.opt.autoUpload&&h.upload()}}function t(){this.opts={},this.opts.headers={"Content-Type":"application/json;charset=utf-8"},this.opts.method="POST",this.opts.async=!0,this.opts.data=null,this.opts.url="",this.opts.baseUrl="",this.withCredentials=!1,this.catch=function(){}}i.prototype.then=function(t,e){var o=this;4==this.xmlHttp.readyState?(this.catch(a(this.xmlHttp)),200<=this.xmlHttp.status&&this.xmlHttp.status<300?t(a(this.xmlHttp)):e(a(this.xmlHttp))):setTimeout(function(){o.then(t,e)},20)},l.prototype.upload=function(){if(this.dom.value){var e=this,t=this.dom.files[0],o=new FormData;o.append("file",t),o.append("parm",JSON.stringify(this.opt.data));var s={formData:o,url:this.opt.url||"",data:this.opt.data||"",addr:this.dom.value||"",isUpload:!1,isCancel:!1,isUploadding:!1,isError:!1,isUploadClear:this.opt.isUploadClear||!1,autoUpload:this.opt.autoUpload||!1};this.fileItem=s,setTimeout(function(){if(e.onBeforeUploadItem(e.fileItem),e.xmlHttp.open("post",e.fileItem.url,!0),e.opt.headers)for(var t in e.opt.headers)e.xmlHttp.setRequestHeader(t,e.opt.headers[t]);e.xmlHttp.send(e.fileItem.formData)},20)}},l.prototype.cancleUploadFile=function(){_this.fileItem.isCancel=!0,_this.fileItem.isUploadding=!1,_this.fileItem.isUpload=!1,this.xmlHttp.abort(),this.clearUploadFile()},l.prototype.clearUploadFile=function(){this.fileItem.isUploadClear&&(this.dom.value="",this.dom.files=null)},t.prototype.creatOpts=function(t){var e=this.opts;for(var o in t)"headers"==o&&(e[o]=s(e[o],t[o])),e[o]=t[o];return e.method=t.method&&t.method.toUpperCase(),e.catch=this.catch,e},t.prototype.ajax=function(t){var e=this.creatOpts(t);return-1!==d.indexOf(e.method.toLowerCase())?r(e):-1!==o.indexOf(e.method.toLowerCase())?n(e):(e.url=this.opts.baseUrl+e.url,new i(e,xmlHttp))},t.prototype.config=function(t){for(var e in t)"headers"!=e?this.opts[e]=t[e]:t[e]=s(this.opts[e],t[e])};var o=["get","del","head","options"],d=["post","put","patch"];for(var e in o)!function(s,i){t.prototype[s[i]]=function(t,e){var o=this.creatOpts(e||{});return o.method=s[i].toUpperCase(),o.url=this.opts.baseUrl+t,n(o)}}(o,e);for(var h in d)!function(s,i){t.prototype[s[i]]=function(t,e,o){return(o=this.creatOpts(o||{})).method=s[i].toUpperCase(),o.url=this.opts.baseUrl+t,o.data=e||{},r(o)}}(d,h);return t.prototype.uploader=function(t,e){var o=document.getElementById(t);if("file"===o.type)return e.url=this.opts.baseUrl+e.url,new l(e,o)},new t});
//# sourceMappingURL=ajax.min.js.map
