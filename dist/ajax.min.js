/**!
 * baby-ajax - v1.6.8
 * One is only 5KB ajax library
 *
 * Mon Jun 10 2019 14:17:01 GMT+0800 (GMT+08:00)
 * MIT (c) hold-baby
*/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).Ajax=e()}(this,function(){"use strict";function s(t,e){for(var o in t){if("headers"===o)for(var a in e[o]=e[o]||{},t[o])e[o][a]=e[o][a]||t[o][a];e[o]=e[o]||t[o]}return e}function a(a,r,i){var n=void 0;for(var t in(n=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")).onreadystatechange=function(){if(4===n.readyState){var e="";try{e=JSON.parse(n.responseText)}catch(t){e=n.responseText?n.responseText:""}var t=n.status,o=n.getAllResponseHeaders().split("\n");200<=n.status&&n.status<300?r(e,t,o):i(e,t,o),a.catch(e,t,o)}},n.open(a.method,a.url,a.async),a.headers)n.setRequestHeader(t,a.headers[t]);n.send(a.data)}var t=!!window.Promise;function d(o){return t?new Promise(a.bind(null,o)):{then:function(t,e){a.call(null,o,t,e)}}}function r(t,e){var o=this,a=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");a.onload=function(t){this.fileItem.isUpload=!0,this.fileItem.isUploadding=!1,this.onSuccessItem(this.fileItem,i(t).res,i(t).status),this.clearUploadFile()}.bind(this),a.onerror=function(t){this.fileItem.isError=!0,this.fileItem.isUploadding=!1,this.onErrorItem(this.fileItem,i(t).res,i(t).status),this.clearUploadFile()}.bind(this),a.upload.onprogress=function(t){var e={},o={};t.lengthComputable&&(o.max=t.total,o.value=t.loaded,e.percent=Math.round(t.loaded/t.total*100));var a=((new Date).getTime()-l)/1e3;l=(new Date).getTime();var r=t.loaded-p;p=t.loaded;var i=r/a,n=i,s="b/s";1<i/1024&&(i/=1024,s="Kb/s");1<i/1024&&(i/=1024,s="Mb/s");i=i.toFixed(1);var d=((t.total-t.loaded)/n).toFixed(1);e.speed=i+s,e.resttime=d,0==n&&(e.bspeed="上传已取消");this.onProgressItem(this.fileItem,e)}.bind(this);var l=void 0,p=void 0;a.upload.onloadstart=function(){l=(new Date).getTime(),p=0,o.fileItem.isUploadding=!0},this.opt=e,this.xhr=a,this.dom=t}function i(t){return{res:JSON.parse(t.target.responseText),status:t.target.status}}var l={baseUrl:"",headers:{"Content-Type":"application/json;charset=utf-8"},async:!0,withCredentials:!(r.prototype={upload:function(){var t=this.dom.files[0],e=this.opt,o=new FormData;o.append("file",t),o.append("parm",JSON.stringify(e.data));var a={formData:o,url:e.url||"",data:e.data||"",addr:this.dom.value||"",isUpload:!1,isCancel:!1,isUploadding:!1,isError:!1,isUploadClear:e.isUploadClear||!1,autoUpload:e.autoUpload||!1};this.fileItem=a,this.xhr.open("post",this.opt.url,!0),this.onBeforeUploadItem(this.fileItem),this.xhr.send(this.fileItem.formData)},onSuccessItem:function(){},onBeforeUploadItem:function(){},onErrorItem:function(){},onProgressItem:function(){},clearUploadFile:function(){this.fileItem.isUploadClear&&(this.dom.value="",this.dom.files=null)},cancleUploadFile:function(){this.fileItem.isCancel=!0,this.fileItem.isUploadding=!1,this.fileItem.isUpload=!1,this.xhr.abort(),this.clearUploadFile()}})};function e(){}var n=["get","delete","head","options"],p=["post","put","patch"],o=function(a){e.prototype[n[a]]=function(t,e){var o=s(l,e=e||{});return o.method=n[a].toUpperCase(),o.url=o.baseUrl+t,o.data=null,o.catch=this.catch,d(o)}};for(var u in n)o(u);var c=function(n){e.prototype[p[n]]=function(t,e,o){(o=o||{}).headers?o.headers["Content-Type"]||(o.headers["Content-Type"]="application/x-www-form-urlencoded;charset=utf-8"):(o.headers={},o.headers["Content-Type"]="application/x-www-form-urlencoded;charset=utf-8");var a=s(l,o);if(a.method=p[n].toUpperCase(),a.url=a.baseUrl+t,a.data=e,a.catch=this.catch,a.data){var r=[];for(var i in a.data)r.push(i+"="+a.data[i]);a.data=r.join("&")}return d(a)}};for(var f in p)c(f);return e.prototype.ajax=function(t){try{var e=t.method.toLowerCase();if(-1!==n.indexOf(e))return this[e](t.url,t);if(-1!==p.indexOf(e))return this[e](t.url,t.data,t);throw new Error("error")}catch(t){throw new Error(t)}},e.prototype.config=function(t){l=s(l,t)},e.prototype.catch=function(){},e.prototype.uploader=function(t,e){var o=s(l,e=e||{});return o.url=o.baseUrl+o.url,new r(document.getElementById(t),o)},new e});
//# sourceMappingURL=ajax.min.js.map
